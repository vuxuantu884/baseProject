{"ast":null,"code":"var _jsxFileName = \"/home/vuxuantu/Desktop/rewarding-platform-client/src/Modules/authentication/Line.tsx\",\n    _s = $RefreshSig$();\n\nimport querystring from \"querystring\";\nimport { memo, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport { ComponentLineButton } from \"@components\";\nimport { enumExternalAuthType, enumExternalMethod, LINE_ACCESS_URL, LINE_SCOPE, PATH_LINE_LOGIN } from \"@configs\";\nimport { selectMerchant, setExternalLogin } from \"@redux\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const ModuleLine = /*#__PURE__*/memo(_c = _s(props => {\n  _s();\n\n  //page hooks\n  const dispatch = useDispatch();\n  const history = useHistory(); //props\n\n  const {\n    state\n  } = props; //redux page\n\n  const {\n    lineIntegration\n  } = useSelector(selectMerchant);\n  const handleLineLogin = useCallback(async () => {\n    var _lineIntegration$line;\n\n    // Build query string.\n    const query = querystring.stringify({\n      response_type: \"code\",\n      client_id: (lineIntegration === null || lineIntegration === void 0 ? void 0 : (_lineIntegration$line = lineIntegration.lineLoginApi) === null || _lineIntegration$line === void 0 ? void 0 : _lineIntegration$line.channelID) || \"\",\n      state: JSON.stringify(state),\n      redirect_uri: `${process.env.REACT_APP_WEB_URL}${PATH_LINE_LOGIN}`\n    });\n    console.log(state.type);\n    await dispatch(setExternalLogin({\n      type: enumExternalMethod.LINE,\n      isSignUp: state.type === enumExternalAuthType.SIGNUP ? true : false\n    })); // Build the Line authorize URL.\n\n    const lineUrl = `${LINE_ACCESS_URL}/authorize?scope=${LINE_SCOPE}&${query}`; // Redirect to external URL.\n\n    window.location.href = lineUrl;\n  }, []);\n  return /*#__PURE__*/_jsxDEV(ComponentLineButton, {\n    onClick: handleLineLogin\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 12\n  }, this);\n}, \"aD4D+0UtpOM22hojZKm9GKoar6A=\", false, function () {\n  return [useDispatch, useHistory, useSelector];\n}));\n_c2 = ModuleLine;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ModuleLine$memo\");\n$RefreshReg$(_c2, \"ModuleLine\");","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Modules/authentication/Line.tsx"],"names":["querystring","memo","useCallback","useDispatch","useSelector","useHistory","ComponentLineButton","enumExternalAuthType","enumExternalMethod","LINE_ACCESS_URL","LINE_SCOPE","PATH_LINE_LOGIN","selectMerchant","setExternalLogin","ModuleLine","props","dispatch","history","state","lineIntegration","handleLineLogin","query","stringify","response_type","client_id","lineLoginApi","channelID","JSON","redirect_uri","process","env","REACT_APP_WEB_URL","console","log","type","LINE","isSignUp","SIGNUP","lineUrl","window","location","href"],"mappings":";;;AAAA,OAAOA,WAAP,MAAwB,aAAxB;AACA,SAASC,IAAT,EAAeC,WAAf,QAAkC,OAAlC;AACA,SAASC,WAAT,EAAsBC,WAAtB,QAAyC,aAAzC;AACA,SAASC,UAAT,QAA2B,cAA3B;AAEA,SAASC,mBAAT,QAAoC,aAApC;AACA,SACIC,oBADJ,EAEIC,kBAFJ,EAGIC,eAHJ,EAIIC,UAJJ,EAKIC,eALJ,QAMO,UANP;AAQA,SAASC,cAAT,EAAyBC,gBAAzB,QAAiD,QAAjD;;AAMA,OAAO,MAAMC,UAAU,gBAAGb,IAAI,SAAEc,KAAD,IAAmB;AAAA;;AAC9C;AACA,QAAMC,QAAQ,GAAGb,WAAW,EAA5B;AACA,QAAMc,OAAO,GAAGZ,UAAU,EAA1B,CAH8C,CAI9C;;AACA,QAAM;AAAEa,IAAAA;AAAF,MAAYH,KAAlB,CAL8C,CAM9C;;AACA,QAAM;AAAEI,IAAAA;AAAF,MAAsBf,WAAW,CAACQ,cAAD,CAAvC;AAEA,QAAMQ,eAAe,GAAGlB,WAAW,CAAC,YAAY;AAAA;;AAC5C;AACA,UAAMmB,KAAK,GAAGrB,WAAW,CAACsB,SAAZ,CAAsB;AAChCC,MAAAA,aAAa,EAAE,MADiB;AAEhCC,MAAAA,SAAS,EAAE,CAAAL,eAAe,SAAf,IAAAA,eAAe,WAAf,qCAAAA,eAAe,CAAEM,YAAjB,gFAA+BC,SAA/B,KAA4C,EAFvB;AAGhCR,MAAAA,KAAK,EAAES,IAAI,CAACL,SAAL,CAAeJ,KAAf,CAHyB;AAIhCU,MAAAA,YAAY,EAAG,GAAEC,OAAO,CAACC,GAAR,CAAYC,iBAAkB,GAAEpB,eAAgB;AAJjC,KAAtB,CAAd;AAMAqB,IAAAA,OAAO,CAACC,GAAR,CAAYf,KAAK,CAACgB,IAAlB;AACA,UAAMlB,QAAQ,CACVH,gBAAgB,CAAC;AACbqB,MAAAA,IAAI,EAAE1B,kBAAkB,CAAC2B,IADZ;AAEbC,MAAAA,QAAQ,EAAElB,KAAK,CAACgB,IAAN,KAAe3B,oBAAoB,CAAC8B,MAApC,GAA6C,IAA7C,GAAoD;AAFjD,KAAD,CADN,CAAd,CAT4C,CAe5C;;AACA,UAAMC,OAAO,GAAI,GAAE7B,eAAgB,oBAAmBC,UAAW,IAAGW,KAAM,EAA1E,CAhB4C,CAkB5C;;AACAkB,IAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuBH,OAAvB;AACH,GApBkC,EAoBhC,EApBgC,CAAnC;AAsBA,sBAAO,QAAC,mBAAD;AAAqB,IAAA,OAAO,EAAElB;AAA9B;AAAA;AAAA;AAAA;AAAA,UAAP;AACH,CAhC6B;AAAA,UAETjB,WAFS,EAGVE,UAHU,EAOED,WAPF;AAAA,GAAvB;MAAMU,U","sourcesContent":["import querystring from \"querystring\";\nimport { memo, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport { ComponentLineButton } from \"@components\";\nimport {\n    enumExternalAuthType,\n    enumExternalMethod,\n    LINE_ACCESS_URL,\n    LINE_SCOPE,\n    PATH_LINE_LOGIN,\n} from \"@configs\";\nimport { IExternalAuthState } from \"@interfaces\";\nimport { selectMerchant, setExternalLogin } from \"@redux\";\n\ninterface IProps {\n    state: IExternalAuthState;\n}\n\nexport const ModuleLine = memo((props: IProps) => {\n    //page hooks\n    const dispatch = useDispatch();\n    const history = useHistory();\n    //props\n    const { state } = props;\n    //redux page\n    const { lineIntegration } = useSelector(selectMerchant);\n\n    const handleLineLogin = useCallback(async () => {\n        // Build query string.\n        const query = querystring.stringify({\n            response_type: \"code\",\n            client_id: lineIntegration?.lineLoginApi?.channelID || \"\",\n            state: JSON.stringify(state),\n            redirect_uri: `${process.env.REACT_APP_WEB_URL}${PATH_LINE_LOGIN}`,\n        });\n        console.log(state.type);\n        await dispatch(\n            setExternalLogin({\n                type: enumExternalMethod.LINE,\n                isSignUp: state.type === enumExternalAuthType.SIGNUP ? true : false,\n            })\n        );\n        // Build the Line authorize URL.\n        const lineUrl = `${LINE_ACCESS_URL}/authorize?scope=${LINE_SCOPE}&${query}`;\n\n        // Redirect to external URL.\n        window.location.href = lineUrl;\n    }, []);\n\n    return <ComponentLineButton onClick={handleLineLogin} />;\n});\n"]},"metadata":{},"sourceType":"module"}