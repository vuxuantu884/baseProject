{"ast":null,"code":"import { __awaiter as t, __generator as r } from \"tslib\";\nimport { UNKNOWN as e, INIT_FAILED as n, INVALID_CONFIG as i, CREDENTIAL_KEYS as o, PERMANENT_LINK_ORIGIN as a, INVALID_ARGUMENT as s } from \"@liff/consts\";\nimport { createLiffError as f } from \"@liff/util\";\nimport { getContext as u, getConfig as l } from \"@liff/store\";\nimport { getEndPoint as c } from \"@liff/server-api\";\n\nfunction h(n) {\n  return t(this, void 0, void 0, function () {\n    var t, i;\n    return r(this, function (r) {\n      switch (r.label) {\n        case 0:\n          return [4, fetch(c(\"permanentLink\"), {\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Accept: \"application/json\"\n            },\n            method: \"POST\",\n            body: JSON.stringify(n)\n          })];\n\n        case 1:\n          return (t = r.sent()).ok ? [3, 3] : [4, t.json()];\n\n        case 2:\n          throw i = r.sent().message, f(e, i);\n\n        case 3:\n          return [4, t.json()];\n\n        case 4:\n          return [2, r.sent()];\n      }\n    });\n  });\n}\n\nvar p = function () {\n  function e() {\n    var e = this;\n    this.extraParams = \"\", this.getAndValidateContext = function () {\n      var t = u();\n      if (!t) throw f(n, \"Could not get Context from server.\");\n      if (!t.endpointUrl) throw f(n, \"Could not get endpointUrl from server.\");\n      if (!t.permanentLinkPattern) throw f(n, \"Could not get permanentLinkPattern from server.\");\n      return t;\n    }, this.createUrl = function () {\n      var t = e.getAndValidateContext(),\n          r = window.location,\n          n = r.pathname,\n          s = r.search,\n          u = r.hash,\n          c = r.origin,\n          h = new URL(t.endpointUrl);\n      if (h.origin !== c || !e.isAncestor(h.pathname, n)) throw f(i, \"Current page is not under entrypoint.\");\n      var p = n.substring(h.pathname.length);\n      p.length > 0 && \"/\" !== p[0] && (p = \"/\" + p);\n\n      var m = new RegExp(\"^\" + o.join(\"|\")),\n          d = u.substring(1).split(\"&\").filter(function (t) {\n        return !m.test(t) && Boolean(t);\n      }).join(\"&\"),\n          g = d === h.hash.substring(1) ? \"\" : d,\n          v = function (t) {\n        return t.substring(1).split(\"&\").filter(function (t) {\n          return !/liff\\.state/.test(t) && Boolean(t);\n        });\n      },\n          w = v(s),\n          x = v(h.search);\n\n      e.extraParams && w.push(e.extraParams);\n\n      for (var U = 0; U < x.length; U++) {\n        var y = x[U],\n            b = w.indexOf(y);\n        b > -1 && w.splice(b, 1);\n      }\n\n      var P = w.join(\"&\"),\n          j = p + (\"\" !== P ? \"?\" + P : \"\") + (g ? \"#\" + g : \"\");\n      return \"\" + a + l().liffId + j;\n    }, this.createUrlBy = function (i) {\n      return t(e, void 0, void 0, function () {\n        var t, e;\n        return r(this, function (r) {\n          switch (r.label) {\n            case 0:\n              if (!(t = l().liffId)) throw f(n, \"Should run after liff init.\");\n\n              try {\n                e = new URL(i);\n              } catch (o) {\n                throw f(s, \"invalid URL.\");\n              }\n\n              return [4, h({\n                liffId: t,\n                currentPageUrl: e.toString()\n              })];\n\n            case 1:\n              return [2, r.sent().permanentLinkUrl];\n          }\n        });\n      });\n    }, this.setExtraQueryParam = function (t) {\n      e.extraParams = t;\n    }, this.isAncestor = function (t, r) {\n      return 0 === r.indexOf(t) && (t.endsWith(\"/\") && (t = t.substring(0, t.length - 1)), void 0 === r[t.length] || \"/\" === r[t.length]);\n    }, this.install = function () {\n      return {\n        createUrl: e.createUrl,\n        createUrlBy: e.createUrlBy,\n        setExtraQueryParam: e.setExtraQueryParam\n      };\n    };\n  }\n\n  return Object.defineProperty(e.prototype, \"name\", {\n    get: function () {\n      return \"permanentLink\";\n    },\n    enumerable: !1,\n    configurable: !0\n  }), e;\n}(),\n    m = new p();\n\nexport { p as PermanentLink, m as module };","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/@liff/permanent-link/lib/index.es.js"],"names":["__awaiter","t","__generator","r","UNKNOWN","e","INIT_FAILED","n","INVALID_CONFIG","i","CREDENTIAL_KEYS","o","PERMANENT_LINK_ORIGIN","a","INVALID_ARGUMENT","s","createLiffError","f","getContext","u","getConfig","l","getEndPoint","c","h","label","fetch","headers","Accept","method","body","JSON","stringify","sent","ok","json","message","p","extraParams","getAndValidateContext","endpointUrl","permanentLinkPattern","createUrl","window","location","pathname","search","hash","origin","URL","isAncestor","substring","length","m","RegExp","join","d","split","filter","test","Boolean","g","v","w","x","push","U","y","b","indexOf","splice","P","j","liffId","createUrlBy","currentPageUrl","toString","permanentLinkUrl","setExtraQueryParam","endsWith","install","Object","defineProperty","prototype","get","enumerable","configurable","PermanentLink","module"],"mappings":"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","sourcesContent":["import{__awaiter as t,__generator as r}from\"tslib\";import{UNKNOWN as e,INIT_FAILED as n,INVALID_CONFIG as i,CREDENTIAL_KEYS as o,PERMANENT_LINK_ORIGIN as a,INVALID_ARGUMENT as s}from\"@liff/consts\";import{createLiffError as f}from\"@liff/util\";import{getContext as u,getConfig as l}from\"@liff/store\";import{getEndPoint as c}from\"@liff/server-api\";function h(n){return t(this,void 0,void 0,(function(){var t,i;return r(this,(function(r){switch(r.label){case 0:return[4,fetch(c(\"permanentLink\"),{headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\"},method:\"POST\",body:JSON.stringify(n)})];case 1:return(t=r.sent()).ok?[3,3]:[4,t.json()];case 2:throw i=r.sent().message,f(e,i);case 3:return[4,t.json()];case 4:return[2,r.sent()]}}))}))}var p=function(){function e(){var e=this;this.extraParams=\"\",this.getAndValidateContext=function(){var t=u();if(!t)throw f(n,\"Could not get Context from server.\");if(!t.endpointUrl)throw f(n,\"Could not get endpointUrl from server.\");if(!t.permanentLinkPattern)throw f(n,\"Could not get permanentLinkPattern from server.\");return t},this.createUrl=function(){var t=e.getAndValidateContext(),r=window.location,n=r.pathname,s=r.search,u=r.hash,c=r.origin,h=new URL(t.endpointUrl);if(h.origin!==c||!e.isAncestor(h.pathname,n))throw f(i,\"Current page is not under entrypoint.\");var p=n.substring(h.pathname.length);p.length>0&&\"/\"!==p[0]&&(p=\"/\"+p);var m=new RegExp(\"^\"+o.join(\"|\")),d=u.substring(1).split(\"&\").filter((function(t){return!m.test(t)&&Boolean(t)})).join(\"&\"),g=d===h.hash.substring(1)?\"\":d,v=function(t){return t.substring(1).split(\"&\").filter((function(t){return!/liff\\.state/.test(t)&&Boolean(t)}))},w=v(s),x=v(h.search);e.extraParams&&w.push(e.extraParams);for(var U=0;U<x.length;U++){var y=x[U],b=w.indexOf(y);b>-1&&w.splice(b,1)}var P=w.join(\"&\"),j=p+(\"\"!==P?\"?\"+P:\"\")+(g?\"#\"+g:\"\");return\"\"+a+l().liffId+j},this.createUrlBy=function(i){return t(e,void 0,void 0,(function(){var t,e;return r(this,(function(r){switch(r.label){case 0:if(!(t=l().liffId))throw f(n,\"Should run after liff init.\");try{e=new URL(i)}catch(o){throw f(s,\"invalid URL.\")}return[4,h({liffId:t,currentPageUrl:e.toString()})];case 1:return[2,r.sent().permanentLinkUrl]}}))}))},this.setExtraQueryParam=function(t){e.extraParams=t},this.isAncestor=function(t,r){return 0===r.indexOf(t)&&(t.endsWith(\"/\")&&(t=t.substring(0,t.length-1)),void 0===r[t.length]||\"/\"===r[t.length])},this.install=function(){return{createUrl:e.createUrl,createUrlBy:e.createUrlBy,setExtraQueryParam:e.setExtraQueryParam}}}return Object.defineProperty(e.prototype,\"name\",{get:function(){return\"permanentLink\"},enumerable:!1,configurable:!0}),e}(),m=new p;export{p as PermanentLink,m as module};\n"]},"metadata":{},"sourceType":"module"}