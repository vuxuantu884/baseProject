{"ast":null,"code":"import _toConsumableArray from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useDispatch}from\"react-redux\";import{useHistory}from\"react-router\";import{couponApi}from\"@api\";import{ComponentCouponList}from\"@components\";import{setLoading}from\"@redux\";import{COUPON,INITIAL_LIST_PARAMS}from\"@configs\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var ModulesCoupon=function ModulesCoupon(){var dispatch=useDispatch();var history=useHistory();//page state\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),coupons=_useState2[0],setCoupons=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingPagination=_useState4[0],setLoadingPagination=_useState4[1];var _useState5=useState(INITIAL_LIST_PARAMS),_useState6=_slicedToArray(_useState5,2),param=_useState6[0],setParam=_useState6[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setLoading(true));_context.next=3;return couponApi.getListCoupon(param);case 3:res=_context.sent;data=res.data.docs;setCoupons(data);dispatch(setLoading(false));case 7:case\"end\":return _context.stop();}}},_callee);}))();},[]);var handleClickItem=function handleClickItem(id){var index=coupons.findIndex(function(coupon){return coupon.qrtable.qrToken===id;});if(index>=0){history.push(COUPON+\"/\"+id+\"/\"+coupons[index]._id);}else{history.push(COUPON+\"/\"+id);}};var handleLoadMore=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var paramFake,res,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:paramFake=_objectSpread(_objectSpread({},param),{},{page:(param.page||1)+1});setParam(paramFake);setLoadingPagination(true);_context2.next=5;return couponApi.getListCoupon(paramFake);case 5:res=_context2.sent;data=res.data.docs;setCoupons([].concat(_toConsumableArray(coupons),_toConsumableArray(data)));setLoadingPagination(false);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLoadMore(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(_Fragment,{children:coupons&&/*#__PURE__*/_jsx(ComponentCouponList,{handleLoadMore:handleLoadMore,data:coupons,handleClickItem:handleClickItem,loadingPagination:loadingPagination})});};","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Modules/Coupon.tsx"],"names":["useEffect","useState","useDispatch","useHistory","couponApi","ComponentCouponList","setLoading","COUPON","INITIAL_LIST_PARAMS","ModulesCoupon","dispatch","history","coupons","setCoupons","loadingPagination","setLoadingPagination","param","setParam","getListCoupon","res","data","docs","handleClickItem","id","index","findIndex","coupon","qrtable","qrToken","push","_id","handleLoadMore","paramFake","page"],"mappings":"u0BAAA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,UAAT,KAA2B,cAA3B,CAEA,OAASC,SAAT,KAA0B,MAA1B,CACA,OAASC,mBAAT,KAAoC,aAApC,CAEA,OAASC,UAAT,KAA2B,QAA3B,CACA,OAASC,MAAT,CAAiBC,mBAAjB,KAA4C,UAA5C,C,gGAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC/B,GAAMC,CAAAA,QAAQ,CAAGR,WAAW,EAA5B,CACA,GAAMS,CAAAA,OAAO,CAAGR,UAAU,EAA1B,CACA;AACA,cAA8BF,QAAQ,CAAgB,EAAhB,CAAtC,wCAAOW,OAAP,eAAgBC,UAAhB,eACA,eAAkDZ,QAAQ,CAAU,KAAV,CAA1D,yCAAOa,iBAAP,eAA0BC,oBAA1B,eACA,eAA0Bd,QAAQ,CAAcO,mBAAd,CAAlC,yCAAOQ,KAAP,eAAcC,QAAd,eAEAjB,SAAS,CAAC,UAAM,CACZ,wDAAC,gJACGU,QAAQ,CAACJ,UAAU,CAAC,IAAD,CAAX,CAAR,CADH,sBAEqBF,CAAAA,SAAS,CAACc,aAAV,CAAwBF,KAAxB,CAFrB,QAESG,GAFT,eAGSC,IAHT,CAGgBD,GAAG,CAACC,IAAJ,CAASC,IAHzB,CAIGR,UAAU,CAACO,IAAD,CAAV,CACAV,QAAQ,CAACJ,UAAU,CAAC,KAAD,CAAX,CAAR,CALH,sDAAD,KAOH,CARQ,CAQN,EARM,CAAT,CAUA,GAAMgB,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,CAACC,EAAD,CAAgB,CACpC,GAAMC,CAAAA,KAAK,CAAGZ,OAAO,CAACa,SAAR,CAAkB,SAACC,MAAD,QAAYA,CAAAA,MAAM,CAACC,OAAP,CAAeC,OAAf,GAA2BL,EAAvC,EAAlB,CAAd,CACA,GAAIC,KAAK,EAAI,CAAb,CAAgB,CACZb,OAAO,CAACkB,IAAR,CAAatB,MAAM,CAAG,GAAT,CAAegB,EAAf,CAAoB,GAApB,CAA0BX,OAAO,CAACY,KAAD,CAAP,CAAeM,GAAtD,EACH,CAFD,IAEO,CACHnB,OAAO,CAACkB,IAAR,CAAatB,MAAM,CAAG,GAAT,CAAegB,EAA5B,EACH,CACJ,CAPD,CASA,GAAMQ,CAAAA,cAAc,2FAAG,+JACbC,SADa,gCAEZhB,KAFY,MAGfiB,IAAI,CAAE,CAACjB,KAAK,CAACiB,IAAN,EAAc,CAAf,EAAoB,CAHX,GAKnBhB,QAAQ,CAACe,SAAD,CAAR,CACAjB,oBAAoB,CAAC,IAAD,CAApB,CANmB,uBAODX,CAAAA,SAAS,CAACc,aAAV,CAAwBc,SAAxB,CAPC,QAObb,GAPa,gBAQbC,IARa,CAQND,GAAG,CAACC,IAAJ,CAASC,IARH,CASnBR,UAAU,8BAAKD,OAAL,qBAAiBQ,IAAjB,GAAV,CACAL,oBAAoB,CAAC,KAAD,CAApB,CAVmB,wDAAH,kBAAdgB,CAAAA,cAAc,2CAApB,CAaA,mBACI,yBACKnB,OAAO,eACJ,KAAC,mBAAD,EACI,cAAc,CAAEmB,cADpB,CAEI,IAAI,CAAEnB,OAFV,CAGI,eAAe,CAAEU,eAHrB,CAII,iBAAiB,CAAER,iBAJvB,EAFR,EADJ,CAYH,CApDM","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n\nimport { couponApi } from \"@api\";\nimport { ComponentCouponList } from \"@components\";\nimport { ICouponList, IPagination } from \"@interfaces\";\nimport { setLoading } from \"@redux\";\nimport { COUPON, INITIAL_LIST_PARAMS } from \"@configs\";\n\nexport const ModulesCoupon = () => {\n    const dispatch = useDispatch();\n    const history = useHistory();\n    //page state\n    const [coupons, setCoupons] = useState<ICouponList[]>([]);\n    const [loadingPagination, setLoadingPagination] = useState<boolean>(false);\n    const [param, setParam] = useState<IPagination>(INITIAL_LIST_PARAMS);\n\n    useEffect(() => {\n        (async () => {\n            dispatch(setLoading(true));\n            const res = await couponApi.getListCoupon(param);\n            const data = res.data.docs as ICouponList[];\n            setCoupons(data);\n            dispatch(setLoading(false));\n        })();\n    }, []);\n\n    const handleClickItem = (id: string) => {\n        const index = coupons.findIndex((coupon) => coupon.qrtable.qrToken === id);\n        if (index >= 0) {\n            history.push(COUPON + \"/\" + id + \"/\" + coupons[index]._id);\n        } else {\n            history.push(COUPON + \"/\" + id);\n        }\n    };\n\n    const handleLoadMore = async () => {\n        const paramFake = {\n            ...param,\n            page: (param.page || 1) + 1,\n        };\n        setParam(paramFake);\n        setLoadingPagination(true);\n        const res = await couponApi.getListCoupon(paramFake);\n        const data = res.data.docs as ICouponList[];\n        setCoupons([...coupons, ...data]);\n        setLoadingPagination(false);\n    };\n\n    return (\n        <>\n            {coupons && (\n                <ComponentCouponList\n                    handleLoadMore={handleLoadMore}\n                    data={coupons}\n                    handleClickItem={handleClickItem}\n                    loadingPagination={loadingPagination}\n                />\n            )}\n        </>\n    );\n};\n"]},"metadata":{},"sourceType":"module"}