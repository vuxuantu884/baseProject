{"ast":null,"code":"import _regeneratorRuntime from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useFormik}from\"formik\";import{useDispatch}from\"react-redux\";import{memo,useState}from\"react\";import{useTranslation}from\"react-i18next\";import{useHistory}from\"react-router\";import{ComponentSignInTel}from\"@components\";import{authApi}from\"@api\";import{setExternalLogin,setLoading}from\"@redux\";import{useNotify}from\"@utils\";import{enumExternalMethod,PATH_OTP}from\"@configs\";import{jsx as _jsx}from\"react/jsx-runtime\";export var ModuleTelSignIn=/*#__PURE__*/memo(function(props){//page hooks\nvar dispatch=useDispatch();var _useNotify=useNotify(),error=_useNotify.error;var _useTranslation=useTranslation(),t=_useTranslation.t;var history=useHistory();//page state\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),errorPhone=_useState2[0],setError=_useState2[1];//page props\nvar remember=props.remember;//page variable\nvar initialValues={phoneNumber:\"\"};var handleRegister=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values,_ref){var setSubmitting,res,data,message;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setSubmitting=_ref.setSubmitting;if(!errorPhone){_context.next=3;break;}return _context.abrupt(\"return\");case 3:if(values.phoneNumber){_context.next=6;break;}setError(t(\"validation.isNumber\"));return _context.abrupt(\"return\");case 6:_context.prev=6;setSubmitting(true);dispatch(setLoading(true));_context.next=11;return authApi.loginPhone({phoneNumber:values.phone||\"\"});case 11:res=_context.sent;data=res.data;if(data){dispatch(setExternalLogin({type:enumExternalMethod.TEL,isSignUp:false}));window.sessionStorage.setItem(\"phoneNumber\",(values===null||values===void 0?void 0:values.phone)||\"\");window.sessionStorage.setItem(\"remember\",(remember||\"\").toString());history.push(PATH_OTP);}_context.next=20;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](6);message=_context.t0.response.data.message;error(message);case 20:_context.prev=20;setSubmitting(false);dispatch(setLoading(false));return _context.finish(20);case 24:case\"end\":return _context.stop();}}},_callee,null,[[6,16,20,24]]);}));return function handleRegister(_x,_x2){return _ref2.apply(this,arguments);};}();var _useFormik=useFormik({initialValues:initialValues,onSubmit:handleRegister}),values=_useFormik.values,handleSubmit=_useFormik.handleSubmit,isSubmitting=_useFormik.isSubmitting,setFieldTouched=_useFormik.setFieldTouched,setFieldValue=_useFormik.setFieldValue;return/*#__PURE__*/_jsx(ComponentSignInTel,{values:values,handleSubmit:handleSubmit,isSubmitting:isSubmitting,setFieldTouched:setFieldTouched,setFieldValue:setFieldValue,errorPhone:errorPhone||\"\",setError:setError});});","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Modules/tel/SignIn.tsx"],"names":["useFormik","useDispatch","memo","useState","useTranslation","useHistory","ComponentSignInTel","authApi","setExternalLogin","setLoading","useNotify","enumExternalMethod","PATH_OTP","ModuleTelSignIn","props","dispatch","error","t","history","errorPhone","setError","remember","initialValues","phoneNumber","handleRegister","values","setSubmitting","loginPhone","phone","res","data","type","TEL","isSignUp","window","sessionStorage","setItem","toString","push","message","response","onSubmit","handleSubmit","isSubmitting","setFieldTouched","setFieldValue"],"mappings":"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","sourcesContent":["import { useFormik, FormikHelpers } from \"formik\";\nimport { useDispatch } from \"react-redux\";\nimport { memo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { useHistory } from \"react-router\";\n\nimport { ComponentSignInTel } from \"@components\";\nimport { IAuth, IPhone } from \"@interfaces\";\nimport { authApi } from \"@api\";\nimport { setExternalLogin, setLoading } from \"@redux\";\nimport { useNotify } from \"@utils\";\nimport { enumExternalMethod, PATH_OTP } from \"@configs\";\n\ninterface IProps {\n    remember?: boolean;\n}\n\nexport const ModuleTelSignIn = memo((props: IProps) => {\n    //page hooks\n    const dispatch = useDispatch();\n    const { error } = useNotify();\n    const { t } = useTranslation();\n    const history = useHistory();\n    //page state\n    const [errorPhone, setError] = useState<string>();\n    //page props\n    const { remember } = props;\n    //page variable\n    const initialValues: IPhone = {\n        phoneNumber: \"\",\n    };\n\n    const handleRegister = async (values: IPhone, { setSubmitting }: FormikHelpers<IPhone>) => {\n        if (errorPhone) return;\n\n        if (!values.phoneNumber) {\n            setError(t(\"validation.isNumber\"));\n            return;\n        }\n\n        try {\n            setSubmitting(true);\n            dispatch(setLoading(true));\n            const res = await authApi.loginPhone({\n                phoneNumber: values.phone || \"\",\n            });\n            const data = res.data as IAuth;\n            if (data) {\n                dispatch(setExternalLogin({ type: enumExternalMethod.TEL, isSignUp: false }));\n                window.sessionStorage.setItem(\"phoneNumber\", values?.phone || \"\");\n                window.sessionStorage.setItem(\"remember\", (remember || \"\").toString());\n                history.push(PATH_OTP);\n            }\n        } catch (errors: any) {\n            const { message } = errors.response.data;\n            error(message);\n        } finally {\n            setSubmitting(false);\n            dispatch(setLoading(false));\n        }\n    };\n\n    const { values, handleSubmit, isSubmitting, setFieldTouched, setFieldValue } = useFormik({\n        initialValues: initialValues,\n        onSubmit: handleRegister,\n    });\n\n    return (\n        <ComponentSignInTel\n            values={values}\n            handleSubmit={handleSubmit}\n            isSubmitting={isSubmitting}\n            setFieldTouched={setFieldTouched}\n            setFieldValue={setFieldValue}\n            errorPhone={errorPhone || \"\"}\n            setError={setError}\n        />\n    );\n});\n"]},"metadata":{},"sourceType":"module"}