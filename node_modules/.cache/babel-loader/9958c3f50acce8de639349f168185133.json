{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport { authApi } from \"@api\";\nexport const login = createAsyncThunk(\"auth/login\", async (values, _ref) => {\n  let {\n    rejectWithValue\n  } = _ref;\n\n  try {\n    const res = await authApi.login(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const lineLogin = createAsyncThunk(\"auth/lineLogin\", async (values, _ref2) => {\n  let {\n    rejectWithValue\n  } = _ref2;\n\n  try {\n    const res = await authApi.lineLogin(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const lineSignup = createAsyncThunk(\"auth/lineSignup\", async (values, _ref3) => {\n  let {\n    rejectWithValue\n  } = _ref3;\n\n  try {\n    const res = await authApi.lineSignup(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const fbLogin = createAsyncThunk(\"auth/fbLogin\", async (values, _ref4) => {\n  let {\n    rejectWithValue\n  } = _ref4;\n\n  try {\n    const res = await authApi.fbLogin(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const fbSignup = createAsyncThunk(\"auth/fbSignup\", async (values, _ref5) => {\n  let {\n    rejectWithValue\n  } = _ref5;\n\n  try {\n    const res = await authApi.fbSignup(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const ggLogin = createAsyncThunk(\"auth/google-signin\", async (values, _ref6) => {\n  let {\n    rejectWithValue\n  } = _ref6;\n\n  try {\n    const res = await authApi.ggLogin(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const ggSignup = createAsyncThunk(\"auth/google-signup\", async (values, _ref7) => {\n  let {\n    rejectWithValue\n  } = _ref7;\n\n  try {\n    const res = await authApi.ggSignup(values);\n    return res.data;\n  } catch (err) {\n    return rejectWithValue(err);\n  }\n});\nexport const getInfo = createAsyncThunk(\"auth/userInfo\", async () => {\n  const res = await authApi.getInfo();\n  return res.data;\n});\nconst initialState = {\n  auth: null,\n  isRemember: false,\n  isLoading: false,\n  error: \"\",\n  tokenInfoAuth: \"\",\n  userInfo: null,\n  externalLogin: null,\n  merchantId: \"\",\n  isSignUp: false,\n  externalType: null,\n  detailUser: false\n};\nconst authSlice = createSlice({\n  name: \"auth\",\n  initialState: initialState,\n  reducers: {\n    logout: () => {\n      return initialState;\n    },\n    setAuth: (state, action) => {\n      state.auth = action.payload;\n    },\n    setInfo: (state, action) => {\n      state.userInfo = { ...state.userInfo,\n        ...action.payload\n      };\n    },\n    setRemember: (state, action) => {\n      state.isRemember = action.payload;\n    },\n    setExternalLogin: (state, action) => {\n      state.externalLogin = action.payload.type;\n      state.line = action.payload.line;\n      state.isSignUp = action.payload.isSignUp || false;\n      state.isLoading = true;\n    },\n    setExternalTypes: (state, action) => {\n      state.externalType = action.payload;\n    },\n    setMerchantID: (state, action) => {\n      state.merchantId = action.payload;\n    },\n    setDetailUser: state => {\n      state.detailUser = !state.detailUser;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(login.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n\n      if (!state.isRemember) {\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        state.auth.refreshToken = null;\n      }\n\n      state.isLoading = false;\n    });\n    builder.addCase(login.pending, state => {\n      state.isLoading = true;\n    });\n    builder.addCase(login.rejected, state => {\n      state.auth = null;\n      state.isLoading = false;\n    });\n    builder.addCase(getInfo.fulfilled, (state, action) => {\n      state.userInfo = action.payload;\n    });\n    builder.addCase(getInfo.rejected, state => {\n      state.userInfo = null;\n    });\n    builder.addCase(lineLogin.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n    });\n    builder.addCase(lineLogin.rejected, state => {\n      state.auth = null;\n      state.externalLogin = null;\n      state.line = null;\n      state.isLoading = false;\n    });\n    builder.addCase(lineSignup.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n    });\n    builder.addCase(lineSignup.rejected, state => {\n      state.auth = null;\n      state.externalLogin = null;\n      state.line = null;\n      state.isLoading = false;\n    });\n    builder.addCase(fbLogin.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n    });\n    builder.addCase(fbLogin.rejected, state => {\n      state.auth = null;\n      state.externalLogin = null;\n      state.isLoading = false;\n    });\n    builder.addCase(fbSignup.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n    });\n    builder.addCase(fbSignup.rejected, state => {\n      state.auth = null;\n      state.externalLogin = null;\n      state.isLoading = false;\n    });\n    builder.addCase(ggLogin.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n    });\n    builder.addCase(ggLogin.rejected, state => {\n      state.auth = null;\n      state.externalLogin = null;\n      state.isLoading = false;\n    });\n    builder.addCase(ggSignup.fulfilled, (state, action) => {\n      if (action.payload.accessToken) {\n        state.auth = action.payload;\n      }\n    });\n    builder.addCase(ggSignup.rejected, state => {\n      state.auth = null;\n      state.externalLogin = null;\n      state.isLoading = false;\n    });\n  }\n});\nexport const selectAuth = state => state.auth;\nexport const {\n  logout,\n  setAuth,\n  setInfo,\n  setRemember,\n  setExternalLogin,\n  setMerchantID,\n  setExternalTypes\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Redux/Slices/auth.ts"],"names":["createAsyncThunk","createSlice","authApi","login","values","rejectWithValue","res","data","err","lineLogin","lineSignup","fbLogin","fbSignup","ggLogin","ggSignup","getInfo","initialState","auth","isRemember","isLoading","error","tokenInfoAuth","userInfo","externalLogin","merchantId","isSignUp","externalType","detailUser","authSlice","name","reducers","logout","setAuth","state","action","payload","setInfo","setRemember","setExternalLogin","type","line","setExternalTypes","setMerchantID","setDetailUser","extraReducers","builder","addCase","fulfilled","accessToken","refreshToken","pending","rejected","selectAuth","actions","reducer"],"mappings":"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","sourcesContent":["import { createAsyncThunk, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\n\nimport {\n    IAuth,\n    IInfo,\n    ILogin,\n    ILineLogin,\n    IFBLogin,\n    IGGLogin,\n    ILineSignup,\n    IFBSignup,\n    IGGSignup,\n} from \"@interfaces\";\nimport { authApi } from \"@api\";\nimport { RootState } from \".\";\nimport { enumExternalMethod, enumTypes } from \"@configs\";\n\nexport const login = createAsyncThunk<IAuth, ILogin>(\n    \"auth/login\",\n    async (values: ILogin, { rejectWithValue }) => {\n        try {\n            const res = await authApi.login(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const lineLogin = createAsyncThunk<IAuth, ILineLogin>(\n    \"auth/lineLogin\",\n    async (values, { rejectWithValue }) => {\n        try {\n            const res = await authApi.lineLogin(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const lineSignup = createAsyncThunk<IAuth, ILineSignup>(\n    \"auth/lineSignup\",\n    async (values, { rejectWithValue }) => {\n        try {\n            const res = await authApi.lineSignup(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const fbLogin = createAsyncThunk<IAuth, IFBLogin>(\n    \"auth/fbLogin\",\n    async (values, { rejectWithValue }) => {\n        try {\n            const res = await authApi.fbLogin(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const fbSignup = createAsyncThunk<IAuth, IFBSignup>(\n    \"auth/fbSignup\",\n    async (values, { rejectWithValue }) => {\n        try {\n            const res = await authApi.fbSignup(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const ggLogin = createAsyncThunk<IAuth, IGGLogin>(\n    \"auth/google-signin\",\n    async (values, { rejectWithValue }) => {\n        try {\n            const res = await authApi.ggLogin(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const ggSignup = createAsyncThunk<IAuth, IGGSignup>(\n    \"auth/google-signup\",\n    async (values, { rejectWithValue }) => {\n        try {\n            const res = await authApi.ggSignup(values);\n            return res.data as IAuth;\n        } catch (err: any) {\n            return rejectWithValue(err);\n        }\n    }\n);\n\nexport const getInfo = createAsyncThunk(\"auth/userInfo\", async () => {\n    const res = await authApi.getInfo();\n    return res.data as IInfo;\n});\n\ninterface IExternalType {\n    type: enumTypes;\n    id: string;\n}\ninterface ILine {\n    code: string | null;\n    state: string;\n}\ninterface IState {\n    auth: IAuth | null;\n    isRemember: boolean;\n    isLoading: boolean;\n    error: string;\n    tokenInfoAuth: string;\n    userInfo: IInfo | null;\n    line?: ILine | null;\n    externalLogin: enumExternalMethod | null;\n    externalType: IExternalType | null;\n    merchantId: string;\n    isSignUp: boolean;\n    detailUser: boolean;\n}\n\ninterface ISetExternalLogin {\n    line?: ILine;\n    type: enumExternalMethod;\n    isSignUp?: boolean;\n}\n\nconst initialState: IState = {\n    auth: null,\n    isRemember: false,\n    isLoading: false,\n    error: \"\",\n    tokenInfoAuth: \"\",\n    userInfo: null,\n    externalLogin: null,\n    merchantId: \"\",\n    isSignUp: false,\n    externalType: null,\n    detailUser: false,\n};\n\nconst authSlice = createSlice({\n    name: \"auth\",\n    initialState: initialState,\n    reducers: {\n        logout: () => {\n            return initialState;\n        },\n        setAuth: (state, action) => {\n            state.auth = action.payload;\n        },\n        setInfo: (state, action) => {\n            state.userInfo = { ...state.userInfo, ...action.payload };\n        },\n        setRemember: (state, action: PayloadAction<boolean>) => {\n            state.isRemember = action.payload;\n        },\n        setExternalLogin: (state, action: PayloadAction<ISetExternalLogin>) => {\n            state.externalLogin = action.payload.type;\n            state.line = action.payload.line;\n            state.isSignUp = action.payload.isSignUp || false;\n            state.isLoading = true;\n        },\n        setExternalTypes: (state, action: PayloadAction<IExternalType>) => {\n            state.externalType = action.payload;\n        },\n        setMerchantID: (state, action: PayloadAction<string>) => {\n            state.merchantId = action.payload;\n        },\n        setDetailUser: (state) => {\n            state.detailUser = !state.detailUser;\n        },\n    },\n    extraReducers: (builder) => {\n        builder.addCase(login.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n            if (!state.isRemember) {\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                state.auth!.refreshToken = null;\n            }\n            state.isLoading = false;\n        });\n\n        builder.addCase(login.pending, (state) => {\n            state.isLoading = true;\n        });\n\n        builder.addCase(login.rejected, (state) => {\n            state.auth = null;\n            state.isLoading = false;\n        });\n\n        builder.addCase(getInfo.fulfilled, (state, action: { payload: IInfo }) => {\n            state.userInfo = action.payload;\n        });\n\n        builder.addCase(getInfo.rejected, (state) => {\n            state.userInfo = null;\n        });\n\n        builder.addCase(lineLogin.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n        });\n\n        builder.addCase(lineLogin.rejected, (state) => {\n            state.auth = null;\n            state.externalLogin = null;\n            state.line = null;\n            state.isLoading = false;\n        });\n\n        builder.addCase(lineSignup.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n        });\n\n        builder.addCase(lineSignup.rejected, (state) => {\n            state.auth = null;\n            state.externalLogin = null;\n            state.line = null;\n            state.isLoading = false;\n        });\n\n        builder.addCase(fbLogin.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n        });\n\n        builder.addCase(fbLogin.rejected, (state) => {\n            state.auth = null;\n            state.externalLogin = null;\n            state.isLoading = false;\n        });\n\n        builder.addCase(fbSignup.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n        });\n\n        builder.addCase(fbSignup.rejected, (state) => {\n            state.auth = null;\n            state.externalLogin = null;\n            state.isLoading = false;\n        });\n\n        builder.addCase(ggLogin.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n        });\n\n        builder.addCase(ggLogin.rejected, (state) => {\n            state.auth = null;\n            state.externalLogin = null;\n            state.isLoading = false;\n        });\n\n        builder.addCase(ggSignup.fulfilled, (state, action: { payload: IAuth }) => {\n            if (action.payload.accessToken) {\n                state.auth = action.payload;\n            }\n        });\n\n        builder.addCase(ggSignup.rejected, (state) => {\n            state.auth = null;\n            state.externalLogin = null;\n            state.isLoading = false;\n        });\n    },\n});\n\nexport const selectAuth = (state: RootState) => state.auth;\n\nexport const {\n    logout,\n    setAuth,\n    setInfo,\n    setRemember,\n    setExternalLogin,\n    setMerchantID,\n    setExternalTypes,\n} = authSlice.actions;\n\nexport default authSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}