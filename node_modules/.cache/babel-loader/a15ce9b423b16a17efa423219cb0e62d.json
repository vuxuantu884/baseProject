{"ast":null,"code":"import _regeneratorRuntime from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import{memo,useCallback}from\"react\";import GoogleLogin from\"react-google-login\";import{useDispatch}from\"react-redux\";import{unwrapResult}from\"@reduxjs/toolkit\";import{useTranslation}from\"react-i18next\";import{ComponentGoogleButton}from\"@components\";import{ggLogin,ggSignup,logout,setExternalLogin}from\"@redux\";import{enumExternalAuthType,enumExternalMethod}from\"@configs\";import{useNotify}from\"@utils\";import{jsx as _jsx}from\"react/jsx-runtime\";export var ModuleGoogle=/*#__PURE__*/memo(function(props){//page hook\nvar _useTranslation=useTranslation(),t=_useTranslation.t;var dispatch=useDispatch();var _useNotify=useNotify(),error=_useNotify.error;var handleGGSuccess=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var accessToken,_response,ggLoginData,ggSignupData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:accessToken=response===null||response===void 0?void 0:response.accessToken;if(!accessToken){if(props.state.type===enumExternalAuthType.LOGIN){error(\"page.auth.sign_in_failed\");}else{error(\"page.auth.sign_up_failed\");}dispatch(logout());}_context.prev=2;if(!(props.state.type===enumExternalAuthType.LOGIN)){_context.next=11;break;}ggLoginData={token:accessToken};_context.next=7;return dispatch(ggLogin(ggLoginData));case 7:_response=_context.sent;//WHAT: wrap function in create async thunk\n//@ts-ignore\nunwrapResult(_response);_context.next=17;break;case 11:if(!(props.state.type===enumExternalAuthType.SIGNUP)){_context.next=17;break;}ggSignupData={token:accessToken};_context.next=15;return dispatch(ggSignup(ggSignupData));case 15:_response=_context.sent;//WHAT: wrap function in create async thunk\n//@ts-ignore\nunwrapResult(_response);case 17://@ts-ignore\nif(!_response.payload.accessToken){error(t(\"page.auth.email_password_correct\"));}_context.next=23;break;case 20:_context.prev=20;_context.t0=_context[\"catch\"](2);props.errorHandler(_context.t0);case 23:case\"end\":return _context.stop();}}},_callee,null,[[2,20]]);}));return function handleGGSuccess(_x){return _ref.apply(this,arguments);};}();var handleGGFail=function handleGGFail(){dispatch(logout());};var handleOnClick=useCallback(function(){dispatch(setExternalLogin({type:enumExternalMethod.GOOGLE,isSignUp:props.state.type===enumExternalAuthType.SIGNUP?true:false}));},[]);return/*#__PURE__*/_jsx(GoogleLogin,{clientId:process.env.REACT_APP_GOOGLE_ID||\"918086977464-i1t2r5gpv27chedpe4jv9raihno46qgt.apps.googleusercontent.com\",render:function render(renderProps){return/*#__PURE__*/_jsx(ComponentGoogleButton,{onClick:renderProps.onClick});},onSuccess:handleGGSuccess,onFailure:handleGGFail,cookiePolicy:\"single_host_origin\",onRequest:handleOnClick});});","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Modules/authentication/Google.tsx"],"names":["memo","useCallback","GoogleLogin","useDispatch","unwrapResult","useTranslation","ComponentGoogleButton","ggLogin","ggSignup","logout","setExternalLogin","enumExternalAuthType","enumExternalMethod","useNotify","ModuleGoogle","props","t","dispatch","error","handleGGSuccess","response","accessToken","state","type","LOGIN","ggLoginData","token","SIGNUP","ggSignupData","payload","errorHandler","handleGGFail","handleOnClick","GOOGLE","isSignUp","process","env","REACT_APP_GOOGLE_ID","renderProps","onClick"],"mappings":"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","sourcesContent":["import { memo, useCallback } from \"react\";\nimport GoogleLogin from \"react-google-login\";\nimport { useDispatch } from \"react-redux\";\nimport { unwrapResult } from \"@reduxjs/toolkit\";\nimport { useTranslation } from \"react-i18next\";\n\nimport { ComponentGoogleButton } from \"@components\";\nimport { ggLogin, ggSignup, logout, setExternalLogin } from \"@redux\";\nimport { IExternalAuthState, IGGLogin, IGGSignup } from \"@interfaces\";\nimport { enumExternalAuthType, enumExternalMethod } from \"@configs\";\nimport { useNotify } from \"@utils\";\n\ninterface IProps {\n    errorHandler: (error: any) => void;\n    state: IExternalAuthState;\n}\n\nexport const ModuleGoogle = memo((props: IProps) => {\n    //page hook\n    const { t } = useTranslation();\n    const dispatch = useDispatch();\n    const { error } = useNotify();\n\n    const handleGGSuccess = async (response: any) => {\n        const accessToken = response?.accessToken;\n        if (!accessToken) {\n            if (props.state.type === enumExternalAuthType.LOGIN) {\n                error(\"page.auth.sign_in_failed\");\n            } else {\n                error(\"page.auth.sign_up_failed\");\n            }\n            dispatch(logout());\n        }\n\n        try {\n            let response;\n            if (props.state.type === enumExternalAuthType.LOGIN) {\n                const ggLoginData: IGGLogin = {\n                    token: accessToken,\n                };\n                response = await dispatch(ggLogin(ggLoginData));\n                //WHAT: wrap function in create async thunk\n                //@ts-ignore\n                unwrapResult(response);\n            } else if (props.state.type === enumExternalAuthType.SIGNUP) {\n                const ggSignupData: IGGSignup = {\n                    token: accessToken,\n                };\n                response = await dispatch(ggSignup(ggSignupData));\n                //WHAT: wrap function in create async thunk\n                //@ts-ignore\n                unwrapResult(response);\n            }\n\n            //@ts-ignore\n            if (!response.payload.accessToken) {\n                error(t(\"page.auth.email_password_correct\"));\n            }\n        } catch (error) {\n            props.errorHandler(error);\n        }\n    };\n\n    const handleGGFail = () => {\n        dispatch(logout());\n    };\n\n    const handleOnClick = useCallback(() => {\n        dispatch(\n            setExternalLogin({\n                type: enumExternalMethod.GOOGLE,\n                isSignUp: props.state.type === enumExternalAuthType.SIGNUP ? true : false,\n            })\n        );\n    }, []);\n\n    return (\n        <GoogleLogin\n            clientId={\n                process.env.REACT_APP_GOOGLE_ID ||\n                \"918086977464-i1t2r5gpv27chedpe4jv9raihno46qgt.apps.googleusercontent.com\"\n            }\n            render={(renderProps) => <ComponentGoogleButton onClick={renderProps.onClick} />}\n            onSuccess={handleGGSuccess}\n            onFailure={handleGGFail}\n            cookiePolicy={\"single_host_origin\"}\n            onRequest={handleOnClick}\n        />\n    );\n});\n"]},"metadata":{},"sourceType":"module"}