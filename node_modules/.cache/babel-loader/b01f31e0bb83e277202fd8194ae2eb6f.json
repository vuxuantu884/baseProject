{"ast":null,"code":"import _toConsumableArray from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{useHistory}from\"react-router\";// import { useHistory } from \"react-router\";\nimport{benefitApi}from\"@api\";import{ComponentBenefitItem,ComponentBenefitList}from\"@components\";// import { IReward } from \"@interfaces\";\nimport{selectMerchant,setLoading}from\"@redux\";// import { REWARD } from \"@configs\";\nimport{INITIAL_LIST_PARAMS,PATH_BENEFIT}from\"@configs\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var ModulesBenefit=function ModulesBenefit(){//page hooks\nvar dispatch=useDispatch();var history=useHistory();//page state\nvar _useState=useState([]),_useState2=_slicedToArray(_useState,2),benefit=_useState2[0],setBenefit=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),loadingPagination=_useState4[0],setLoadingPagination=_useState4[1];var _useState5=useState(INITIAL_LIST_PARAMS),_useState6=_slicedToArray(_useState5,2),param=_useState6[0],setParam=_useState6[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(setLoading(true));_context.next=3;return benefitApi.getListBenefit(param);case 3:res=_context.sent;data=res.data.docs;setBenefit(data);dispatch(setLoading(false));case 7:case\"end\":return _context.stop();}}},_callee);}))();},[]);var handleClick=function handleClick(id){history.push(PATH_BENEFIT+\"/\"+id);};var handleLoadMore=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var paramFake,res,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:paramFake=_objectSpread(_objectSpread({},param),{},{page:(param.page||1)+1});setParam(paramFake);setLoadingPagination(true);_context2.next=5;return benefitApi.getListBenefit(paramFake);case 5:res=_context2.sent;data=res.data.docs;setBenefit([].concat(_toConsumableArray(benefit),_toConsumableArray(data)));setLoadingPagination(false);case 9:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLoadMore(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",benefit&&/*#__PURE__*/_jsx(ComponentBenefitList,{data:benefit,loadingPagination:loadingPagination,handleLoadMore:handleLoadMore,handleClick:handleClick})]});};export var ModulesBenefitItem=function ModulesBenefitItem(props){//page props\nvar data=props.data,handleClick=props.handleClick;//redux state\nvar _useSelector=useSelector(selectMerchant),membershipTiers=_useSelector.membershipTiers;//page state\nvar _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),dataRanks=_useState8[0],setDataRanks=_useState8[1];//page variable\nvar levelIds=data.levelIds;useEffect(function(){if(levelIds.length===0){setDataRanks(membershipTiers||[]);}else{levelIds.forEach(function(item){//\nvar check=(membershipTiers===null||membershipTiers===void 0?void 0:membershipTiers.findIndex(function(value){return value._id===item;}))||0;if(check>=0&&membershipTiers){dataRanks.push(membershipTiers[check]);}});setDataRanks(_toConsumableArray(dataRanks));}},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[\" \",/*#__PURE__*/_jsx(ComponentBenefitItem,{data:data,handleClick:handleClick,dataRanks:dataRanks})]});};","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Modules/Benefit.tsx"],"names":["useEffect","useState","useDispatch","useSelector","useHistory","benefitApi","ComponentBenefitItem","ComponentBenefitList","selectMerchant","setLoading","INITIAL_LIST_PARAMS","PATH_BENEFIT","ModulesBenefit","dispatch","history","benefit","setBenefit","loadingPagination","setLoadingPagination","param","setParam","getListBenefit","res","data","docs","handleClick","id","push","handleLoadMore","paramFake","page","ModulesBenefitItem","props","membershipTiers","dataRanks","setDataRanks","levelIds","length","forEach","item","check","findIndex","value","_id"],"mappings":"u0BAAA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,OAASC,WAAT,CAAsBC,WAAtB,KAAyC,aAAzC,CACA,OAASC,UAAT,KAA2B,cAA3B,CACA;AAEA,OAASC,UAAT,KAA2B,MAA3B,CACA,OAASC,oBAAT,CAA+BC,oBAA/B,KAA2D,aAA3D,CACA;AACA,OAASC,cAAT,CAAyBC,UAAzB,KAA2C,QAA3C,CACA;AAEA,OAASC,mBAAT,CAA8BC,YAA9B,KAAkD,UAAlD,C,6IAEA,MAAO,IAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAChC;AACA,GAAMC,CAAAA,QAAQ,CAAGX,WAAW,EAA5B,CACA,GAAMY,CAAAA,OAAO,CAAGV,UAAU,EAA1B,CACA;AACA,cAA8BH,QAAQ,CAAa,EAAb,CAAtC,wCAAOc,OAAP,eAAgBC,UAAhB,eACA,eAAkDf,QAAQ,CAAU,KAAV,CAA1D,yCAAOgB,iBAAP,eAA0BC,oBAA1B,eACA,eAA0BjB,QAAQ,CAAcS,mBAAd,CAAlC,yCAAOS,KAAP,eAAcC,QAAd,eAEApB,SAAS,CAAC,UAAM,CACZ,wDAAC,gJACGa,QAAQ,CAACJ,UAAU,CAAC,IAAD,CAAX,CAAR,CADH,sBAEqBJ,CAAAA,UAAU,CAACgB,cAAX,CAA0BF,KAA1B,CAFrB,QAESG,GAFT,eAGSC,IAHT,CAGgBD,GAAG,CAACC,IAAJ,CAASC,IAHzB,CAIGR,UAAU,CAACO,IAAD,CAAV,CACAV,QAAQ,CAACJ,UAAU,CAAC,KAAD,CAAX,CAAR,CALH,sDAAD,KAOH,CARQ,CAQN,EARM,CAAT,CAUA,GAAMgB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,EAAD,CAAgB,CAChCZ,OAAO,CAACa,IAAR,CAAahB,YAAY,CAAG,GAAf,CAAqBe,EAAlC,EACH,CAFD,CAIA,GAAME,CAAAA,cAAc,2FAAG,+JACbC,SADa,gCAEZV,KAFY,MAGfW,IAAI,CAAE,CAACX,KAAK,CAACW,IAAN,EAAc,CAAf,EAAoB,CAHX,GAKnBV,QAAQ,CAACS,SAAD,CAAR,CACAX,oBAAoB,CAAC,IAAD,CAApB,CANmB,uBAODb,CAAAA,UAAU,CAACgB,cAAX,CAA0BQ,SAA1B,CAPC,QAObP,GAPa,gBAQbC,IARa,CAQND,GAAG,CAACC,IAAJ,CAASC,IARH,CASnBR,UAAU,8BAAKD,OAAL,qBAAiBQ,IAAjB,GAAV,CACAL,oBAAoB,CAAC,KAAD,CAApB,CAVmB,wDAAH,kBAAdU,CAAAA,cAAc,2CAApB,CAaA,mBACI,2BACK,GADL,CAEKb,OAAO,eACJ,KAAC,oBAAD,EACI,IAAI,CAAEA,OADV,CAEI,iBAAiB,CAAEE,iBAFvB,CAGI,cAAc,CAAEW,cAHpB,CAII,WAAW,CAAEH,WAJjB,EAHR,GADJ,CAaH,CAjDM,CAwDP,MAAO,IAAMM,CAAAA,kBAAkB,CAAG,QAArBA,CAAAA,kBAAqB,CAACC,KAAD,CAAmB,CACjD;AACA,GAAQT,CAAAA,IAAR,CAA8BS,KAA9B,CAAQT,IAAR,CAAcE,WAAd,CAA8BO,KAA9B,CAAcP,WAAd,CACA;AACA,iBAA4BtB,WAAW,CAACK,cAAD,CAAvC,CAAQyB,eAAR,cAAQA,eAAR,CACA;AACA,eAAkChC,QAAQ,CAAoB,EAApB,CAA1C,yCAAOiC,SAAP,eAAkBC,YAAlB,eACA;AACA,GAAMC,CAAAA,QAAQ,CAAGb,IAAI,CAACa,QAAtB,CAEApC,SAAS,CAAC,UAAM,CACZ,GAAIoC,QAAQ,CAACC,MAAT,GAAoB,CAAxB,CAA2B,CACvBF,YAAY,CAACF,eAAe,EAAI,EAApB,CAAZ,CACH,CAFD,IAEO,CACHG,QAAQ,CAACE,OAAT,CAAiB,SAACC,IAAD,CAAU,CACvB;AACA,GAAMC,CAAAA,KAAK,CAAG,CAAAP,eAAe,OAAf,EAAAA,eAAe,SAAf,QAAAA,eAAe,CAAEQ,SAAjB,CAA2B,SAACC,KAAD,QAAWA,CAAAA,KAAK,CAACC,GAAN,GAAcJ,IAAzB,EAA3B,IAA6D,CAA3E,CACA,GAAIC,KAAK,EAAI,CAAT,EAAcP,eAAlB,CAAmC,CAC/BC,SAAS,CAACP,IAAV,CAAeM,eAAe,CAACO,KAAD,CAA9B,EACH,CACJ,CAND,EAOAL,YAAY,oBAAKD,SAAL,EAAZ,CACH,CACJ,CAbQ,CAaN,EAbM,CAAT,CAeA,mBACI,2BACK,GADL,cAEI,KAAC,oBAAD,EAAsB,IAAI,CAAEX,IAA5B,CAAkC,WAAW,CAAEE,WAA/C,CAA4D,SAAS,CAAES,SAAvE,EAFJ,GADJ,CAMH,CA/BM","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { useHistory } from \"react-router\";\n// import { useHistory } from \"react-router\";\n\nimport { benefitApi } from \"@api\";\nimport { ComponentBenefitItem, ComponentBenefitList } from \"@components\";\n// import { IReward } from \"@interfaces\";\nimport { selectMerchant, setLoading } from \"@redux\";\n// import { REWARD } from \"@configs\";\nimport { IBenefit, IMembershipTier, IPagination } from \"@interfaces\";\nimport { INITIAL_LIST_PARAMS, PATH_BENEFIT } from \"@configs\";\n\nexport const ModulesBenefit = () => {\n    //page hooks\n    const dispatch = useDispatch();\n    const history = useHistory();\n    //page state\n    const [benefit, setBenefit] = useState<IBenefit[]>([]);\n    const [loadingPagination, setLoadingPagination] = useState<boolean>(false);\n    const [param, setParam] = useState<IPagination>(INITIAL_LIST_PARAMS);\n\n    useEffect(() => {\n        (async () => {\n            dispatch(setLoading(true));\n            const res = await benefitApi.getListBenefit(param);\n            const data = res.data.docs as IBenefit[];\n            setBenefit(data);\n            dispatch(setLoading(false));\n        })();\n    }, []);\n\n    const handleClick = (id: string) => {\n        history.push(PATH_BENEFIT + \"/\" + id);\n    };\n\n    const handleLoadMore = async () => {\n        const paramFake = {\n            ...param,\n            page: (param.page || 1) + 1,\n        };\n        setParam(paramFake);\n        setLoadingPagination(true);\n        const res = await benefitApi.getListBenefit(paramFake);\n        const data = res.data.docs as IBenefit[];\n        setBenefit([...benefit, ...data]);\n        setLoadingPagination(false);\n    };\n\n    return (\n        <>\n            {\" \"}\n            {benefit && (\n                <ComponentBenefitList\n                    data={benefit}\n                    loadingPagination={loadingPagination}\n                    handleLoadMore={handleLoadMore}\n                    handleClick={handleClick}\n                />\n            )}\n        </>\n    );\n};\n\ninterface IProps {\n    data: IBenefit;\n    handleClick: (id: string) => void;\n}\n\nexport const ModulesBenefitItem = (props: IProps) => {\n    //page props\n    const { data, handleClick } = props;\n    //redux state\n    const { membershipTiers } = useSelector(selectMerchant);\n    //page state\n    const [dataRanks, setDataRanks] = useState<IMembershipTier[]>([]);\n    //page variable\n    const levelIds = data.levelIds;\n\n    useEffect(() => {\n        if (levelIds.length === 0) {\n            setDataRanks(membershipTiers || []);\n        } else {\n            levelIds.forEach((item) => {\n                //\n                const check = membershipTiers?.findIndex((value) => value._id === item) || 0;\n                if (check >= 0 && membershipTiers) {\n                    dataRanks.push(membershipTiers[check]);\n                }\n            });\n            setDataRanks([...dataRanks]);\n        }\n    }, []);\n\n    return (\n        <>\n            {\" \"}\n            <ComponentBenefitItem data={data} handleClick={handleClick} dataRanks={dataRanks} />\n        </>\n    );\n};\n"]},"metadata":{},"sourceType":"module"}