{"ast":null,"code":"import _regeneratorRuntime from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/vuxuantu/Desktop/rewarding-platform-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";import{useHistory,useParams}from\"react-router\";import{useDispatch}from\"react-redux\";import{useTranslation}from\"react-i18next\";import{rewardApi}from\"@api\";import{setLoading}from\"@redux\";import{ComponentPopUpConfirm,ComponentRewardDetail,ComponentSelectType}from\"@components\";import{enumStatus,enumTypes,enumValidation,PATH_HOME}from\"@configs\";import{useNotify}from\"@utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var PageReward=function PageReward(){//page hooks\nvar _useParams=useParams(),id=_useParams.id;var dispatch=useDispatch();var _useNotify=useNotify(),error=_useNotify.error,success=_useNotify.success;var _useTranslation=useTranslation(),t=_useTranslation.t;var history=useHistory();//page state\nvar _useState=useState(),_useState2=_slicedToArray(_useState,2),reward=_useState2[0],setReward=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),count=_useState4[0],setCount=_useState4[1];var _useState5=useState(enumValidation.NUMBER_ONE),_useState6=_slicedToArray(_useState5,2),currentImage=_useState6[0],setCurrentImage=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showConfirm=_useState8[0],setShowConfirm=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showSelectType=_useState10[0],setShowSelectType=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),variant=_useState12[0],setVariant=_useState12[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!id){_context.next=8;break;}dispatch(setLoading(true));_context.next=4;return rewardApi.getDetailById(id);case 4:res=_context.sent;data=res.data;setReward(data);dispatch(setLoading(false));case 8:case\"end\":return _context.stop();}}},_callee);}))();},[]);var handleAddCount=function handleAddCount(){if(reward){if(count<(reward.limit||1)){setCount(count+1);}}};var handleMinusCount=function handleMinusCount(){if(count>1){setCount(count-1);}};var handleCalculatePoint=function handleCalculatePoint(){if(reward&&reward.point){return reward.point*count;}else{return 0;}};var handleUseReward=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!reward){_context2.next=14;break;}_context2.prev=1;_context2.next=4;return rewardApi.redeemed({objectId:reward._id||\"\",quantity:count,status:enumStatus.ACTIVE,type:enumTypes.REWARD,variants:[variant]});case 4:res=_context2.sent;if(res.data.message){success(res.data.message);}history.push(PATH_HOME);_context2.next=14;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);message=_context2.t0.response.data.message;if(message){error(message);}else{error(t(\"message.use_coupon.fail\"));}history.push(PATH_HOME);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function handleUseReward(){return _ref2.apply(this,arguments);};}();var handleChangeImage=function handleChangeImage(swiper){setCurrentImage(swiper.realIndex+1);};var handleChangeVariant=function handleChangeVariant(value){//\nsetVariant(value);};var handleToggleConfirm=function handleToggleConfirm(){setShowConfirm(!showConfirm);};var handleToggleShowSelectType=function handleToggleShowSelectType(){setShowSelectType(!showSelectType);};return/*#__PURE__*/_jsxs(_Fragment,{children:[reward&&!showSelectType&&/*#__PURE__*/_jsx(ComponentRewardDetail,{handleAddCount:handleAddCount,handleMinusCount:handleMinusCount,handleCalculatePoint:handleCalculatePoint,count:count,data:reward,handleToggleConfirm:handleToggleConfirm,currentImage:currentImage,handleChangeImage:handleChangeImage,handleToggleShowSelectType:handleToggleShowSelectType,variant:variant,variants:(reward===null||reward===void 0?void 0:reward.variants)||[]}),showConfirm&&reward&&/*#__PURE__*/_jsx(ComponentPopUpConfirm,{handleCloseDetail:handleToggleConfirm,data:reward,handleConfirm:handleUseReward,handleCalculatePoint:handleCalculatePoint}),showSelectType&&reward&&/*#__PURE__*/_jsx(ComponentSelectType,{variant:variant,variants:(reward===null||reward===void 0?void 0:reward.variants)||[],handleChangeVariant:handleChangeVariant,handleToggleShowSelectType:handleToggleShowSelectType})]});};","map":{"version":3,"sources":["/home/vuxuantu/Desktop/rewarding-platform-client/src/Pages/Reward.tsx"],"names":["useEffect","useState","useHistory","useParams","useDispatch","useTranslation","rewardApi","setLoading","ComponentPopUpConfirm","ComponentRewardDetail","ComponentSelectType","enumStatus","enumTypes","enumValidation","PATH_HOME","useNotify","PageReward","id","dispatch","error","success","t","history","reward","setReward","count","setCount","NUMBER_ONE","currentImage","setCurrentImage","showConfirm","setShowConfirm","showSelectType","setShowSelectType","variant","setVariant","getDetailById","res","data","handleAddCount","limit","handleMinusCount","handleCalculatePoint","point","handleUseReward","redeemed","objectId","_id","quantity","status","ACTIVE","type","REWARD","variants","message","push","response","handleChangeImage","swiper","realIndex","handleChangeVariant","value","handleToggleConfirm","handleToggleShowSelectType"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\nimport { useHistory, useParams } from \"react-router\";\nimport { useDispatch } from \"react-redux\";\nimport { useTranslation } from \"react-i18next\";\nimport SwiperCore from \"swiper\";\n\nimport { IReward } from \"@interfaces\";\nimport { rewardApi } from \"@api\";\nimport { setLoading } from \"@redux\";\nimport { ComponentPopUpConfirm, ComponentRewardDetail, ComponentSelectType } from \"@components\";\nimport { enumStatus, enumTypes, enumValidation, PATH_HOME } from \"@configs\";\nimport { useNotify } from \"@utils\";\n\nexport const PageReward = () => {\n    //page hooks\n    const { id } = useParams<{ id: string }>();\n    const dispatch = useDispatch();\n    const { error, success } = useNotify();\n    const { t } = useTranslation();\n    const history = useHistory();\n\n    //page state\n    const [reward, setReward] = useState<IReward>();\n    const [count, setCount] = useState<number>(1);\n    const [currentImage, setCurrentImage] = useState<number>(enumValidation.NUMBER_ONE);\n    const [showConfirm, setShowConfirm] = useState<boolean>(false);\n    const [showSelectType, setShowSelectType] = useState<boolean>(false);\n    const [variant, setVariant] = useState<string>(\"\");\n\n    useEffect(() => {\n        (async () => {\n            if (id) {\n                dispatch(setLoading(true));\n                const res = await rewardApi.getDetailById(id);\n                const data = res.data as IReward;\n                setReward(data);\n                dispatch(setLoading(false));\n            }\n        })();\n    }, []);\n    const handleAddCount = () => {\n        if (reward) {\n            if (count < (reward.limit || 1)) {\n                setCount(count + 1);\n            }\n        }\n    };\n    const handleMinusCount = () => {\n        if (count > 1) {\n            setCount(count - 1);\n        }\n    };\n\n    const handleCalculatePoint = () => {\n        if (reward && reward.point) {\n            return reward.point * count;\n        } else {\n            return 0;\n        }\n    };\n\n    const handleUseReward = async () => {\n        //\n        if (reward) {\n            try {\n                const res = await rewardApi.redeemed({\n                    objectId: reward._id || \"\",\n                    quantity: count,\n                    status: enumStatus.ACTIVE,\n                    type: enumTypes.REWARD,\n                    variants: [variant],\n                });\n                if (res.data.message) {\n                    success(res.data.message);\n                }\n                history.push(PATH_HOME);\n            } catch (err: any) {\n                const { message } = err.response.data;\n                if (message) {\n                    error(message);\n                } else {\n                    error(t(\"message.use_coupon.fail\"));\n                }\n                history.push(PATH_HOME);\n            }\n        }\n    };\n\n    const handleChangeImage = (swiper: SwiperCore) => {\n        setCurrentImage(swiper.realIndex + 1);\n    };\n\n    const handleChangeVariant = (value: string) => {\n        //\n        setVariant(value);\n    };\n\n    const handleToggleConfirm = () => {\n        setShowConfirm(!showConfirm);\n    };\n\n    const handleToggleShowSelectType = () => {\n        setShowSelectType(!showSelectType);\n    };\n\n    return (\n        <>\n            {reward && !showSelectType && (\n                <ComponentRewardDetail\n                    handleAddCount={handleAddCount}\n                    handleMinusCount={handleMinusCount}\n                    handleCalculatePoint={handleCalculatePoint}\n                    count={count}\n                    data={reward}\n                    handleToggleConfirm={handleToggleConfirm}\n                    currentImage={currentImage}\n                    handleChangeImage={handleChangeImage}\n                    handleToggleShowSelectType={handleToggleShowSelectType}\n                    variant={variant}\n                    variants={reward?.variants || []}\n                />\n            )}\n            {showConfirm && reward && (\n                <ComponentPopUpConfirm\n                    handleCloseDetail={handleToggleConfirm}\n                    data={reward as IReward}\n                    handleConfirm={handleUseReward}\n                    handleCalculatePoint={handleCalculatePoint}\n                />\n            )}\n\n            {showSelectType && reward && (\n                <ComponentSelectType\n                    variant={variant}\n                    variants={reward?.variants || []}\n                    handleChangeVariant={handleChangeVariant}\n                    handleToggleShowSelectType={handleToggleShowSelectType}\n                />\n            )}\n        </>\n    );\n};\n"]},"metadata":{},"sourceType":"module"}