import{INVALID_CONFIG as i}from"@liff/consts";import{logger as r}from"@liff/logger";import{hexToBase64 as e,randomAlphaNumericString as o,createLiffError as t,qs as f}from"@liff/util";import{getConfig as n,setLoginTmp as l}from"@liff/store";import{getEndPoint as p}from"@liff/server-api";import{getVersion as c}from"@liff/get-version";import{isSubWindow as d}from"@liff/is-sub-window";import{isInClient as a}from"@liff/is-in-client";import m from"tiny-sha256";var s=function(){function s(i){this.driver=i}return Object.defineProperty(s.prototype,"name",{get:function(){return"login"},enumerable:!1,configurable:!0}),s.prototype.install=function(){return this.login.bind(this)},s.prototype.login=function(s){this.driver.runSyncHook("beforeLogin",s);var u=o(43),g=e(m(u)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),h=n();if(!h||!h.liffId)throw t(i,"You need to define `liffId` for liff.login()");var _={app_id:h.liffId,state:o(12),response_type:"code",code_challenge_method:"S256",code_challenge:g,liff_sdk_version:c()};s&&s.redirectUri&&(_.redirect_uri=s.redirectUri),d()&&!a()&&(_.disable_auto_login="true"),l({codeVerifier:u});var v=p("authorize")+"?"+f.stringify(_);r.debug("[Redirect] "+v),window.location.href=v},s}();export{s as LoginModule};
