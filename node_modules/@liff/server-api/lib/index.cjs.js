"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tslib"),t=require("@liff/consts"),a=require("@liff/util"),r=require("@liff/store");function n(r){return e.__awaiter(this,void 0,void 0,(function(){var n,s,i;return e.__generator(this,(function(e){switch(e.label){case 0:if(!r.ok)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,r.json()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,r];case 4:return n=String(r.status),s=a.HTTPStatusCodes.has(n)?n:t.UNKNOWN,[4,r.json().catch((function(){throw a.createLiffError(s,r.statusText)}))];case 5:throw i=e.sent(),a.createLiffError(i.error||s,i.error_description||i.message)}}))}))}function s(n){var s=function(e){if(e)return e;var n=r.getAccessToken();if(!n)throw a.createLiffError(t.UNAUTHORIZED,"Need access_token for api call, Please login first");return{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer "+n}}(n&&n.headers);return e.__assign(e.__assign({},n),{headers:s})}function i(e,t){var a;try{a=s(t)}catch(r){return Promise.reject(r)}return fetch(e,a).then(n)}function o(e){var t=e.subdomain;return"https://"+(void 0===t?"api":t)+".line.me/"+e.pathname}var u={token:o({pathname:"oauth2/v2.1/token"}),certs:o({pathname:"oauth2/v2.1/certs"}),"openid-configuration":o({subdomain:"access",pathname:".well-known/openid-configuration"}),authorize:o({subdomain:"access",pathname:"liff/v1/authorize"}),profile:o({pathname:"v2/profile"}),message:o({pathname:"message/v3/share"}),messageOTT:o({pathname:"message/v3/multisend?type=ott"}),friendship:o({pathname:"friendship/v1/status"}),shareTargetPicker:o({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker"}),shareTargetPickerOtt:o({pathname:"liff/v2/apps"}),shareTargetPickerResult:o({subdomain:"access",pathname:"oauth2/v2.1/liff/shareTargetPicker/result"}),apps:o({pathname:"liff/v2/apps"}),subWindowGetMSIT:o({pathname:"liff/v2/sub/msit"}),subWindowGetMSTByMSIT:o({pathname:"liff/v2/sub/mst"}),subWindowSubscribe:o({subdomain:"liff",pathname:"liff/v2/sub/waitResult"}),subWindowPost:o({pathname:"liff/v2/sub/result"}),subWindowGetAppData:o({pathname:"liff/v2/sub/appData"}),subWindowGetOrigin:function(e){return o({pathname:"liff/v2/sub/"+e+"/origin"})},accessTokenVerify:o({pathname:"oauth2/v2.1/verify"}),unauthorizedPermissions:o({subdomain:"liff",pathname:"liff/v2/incrementalAgreement/unauthorizedPermissions"}),permanentLink:o({subdomain:"liff",pathname:"liff/v2/permanentLink"})};function c(e){return u[e]}exports.fetch=i,exports.getEndPoint=c,exports.requestWithoutErrorHandling=function(e,t){var a;try{a=s(t)}catch(r){return Promise.reject(r)}return fetch(e,a)},exports.verifyAccessToken=function(e){return i(c("accessTokenVerify")+"?access_token="+encodeURIComponent(e),{headers:{"Content-Type":"application/json",Accept:"application/json"}})};
